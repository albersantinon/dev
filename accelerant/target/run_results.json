{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.17", "generated_at": "2024-06-25T17:08:48.870489Z", "invocation_id": "15e313ca-023d-4548-a2b3-a7c9ccce99d3", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-25T17:08:43.692147Z", "completed_at": "2024-06-25T17:08:43.700647Z"}, {"name": "execute", "started_at": "2024-06-25T17:08:43.724938Z", "completed_at": "2024-06-25T17:08:44.037216Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.36119985580444336, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b53fe4-0105-42fd-0003-3477001a599a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.acme_ecommerce.stg_reference_data_src__countries", "compiled": true, "compiled_code": "with source as (\n\n    select * from acme_ecommerce.reference_data.country\n\n)\n\nselect * from source", "relation_name": "analytics.albertosantinon7_staging.stg_reference_data_src__countries"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-25T17:08:43.683706Z", "completed_at": "2024-06-25T17:08:43.700187Z"}, {"name": "execute", "started_at": "2024-06-25T17:08:43.702581Z", "completed_at": "2024-06-25T17:08:44.042299Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3666112422943115, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b53fe4-0105-3f19-0003-3477001b50b2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.acme_ecommerce.stg_product_inventory_src__product_inventories", "compiled": true, "compiled_code": "with source as (\n\n    select * from acme_ecommerce.product_inventory.inventory\n\n)\n\nselect * from source", "relation_name": "analytics.albertosantinon7_staging.stg_product_inventory_src__product_inventories"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-25T17:08:43.694790Z", "completed_at": "2024-06-25T17:08:43.701472Z"}, {"name": "execute", "started_at": "2024-06-25T17:08:43.727364Z", "completed_at": "2024-06-25T17:08:44.070814Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.39258623123168945, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b53fe4-0105-42ff-0003-3477001b4312"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.acme_ecommerce.stg_reference_data_src__customers", "compiled": true, "compiled_code": "with source as (\n\n    select * from acme_ecommerce.reference_data.customer\n\n)\n\nselect * from source", "relation_name": "analytics.albertosantinon7_staging.stg_reference_data_src__customers"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-25T17:08:44.074430Z", "completed_at": "2024-06-25T17:08:44.076885Z"}, {"name": "execute", "started_at": "2024-06-25T17:08:44.077453Z", "completed_at": "2024-06-25T17:08:44.346273Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2740030288696289, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b53fe4-0105-3f1d-0003-3477001b37ee"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.acme_ecommerce.stg_transactional_src__orders_q3", "compiled": true, "compiled_code": "with source as (\n\n    select * from acme_ecommerce.transactional.order_2023_q3\n\n)\n\nselect * from source", "relation_name": "analytics.albertosantinon7_staging.stg_transactional_src__orders_q3"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-25T17:08:44.053304Z", "completed_at": "2024-06-25T17:08:44.056642Z"}, {"name": "execute", "started_at": "2024-06-25T17:08:44.060613Z", "completed_at": "2024-06-25T17:08:44.630379Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5838091373443604, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b53fe4-0105-4303-0003-3477001a1a0e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.acme_ecommerce.stg_transactional_src__orders_q2", "compiled": true, "compiled_code": "with source as (\n\n    select * from acme_ecommerce.transactional.order_2023_q2\n\n)\n\nselect * from source", "relation_name": "analytics.albertosantinon7_staging.stg_transactional_src__orders_q2"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-25T17:08:44.352911Z", "completed_at": "2024-06-25T17:08:44.358678Z"}, {"name": "execute", "started_at": "2024-06-25T17:08:44.359753Z", "completed_at": "2024-06-25T17:08:44.654289Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.30413103103637695, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b53fe4-0105-42ff-0003-3477001b4316"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.acme_ecommerce.stg_transactional_src__orders_q4", "compiled": true, "compiled_code": "with source as (\n\n    select * from acme_ecommerce.transactional.order_2023_q4\n\n)\n\nselect * from source", "relation_name": "analytics.albertosantinon7_staging.stg_transactional_src__orders_q4"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-25T17:08:44.048627Z", "completed_at": "2024-06-25T17:08:44.056216Z"}, {"name": "execute", "started_at": "2024-06-25T17:08:44.057742Z", "completed_at": "2024-06-25T17:08:44.670464Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6248230934143066, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b53fe4-0105-4303-0003-3477001a1a0a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.acme_ecommerce.stg_transactional_src__orders_q1", "compiled": true, "compiled_code": "with source as (\n\n    select * from acme_ecommerce.transactional.order_2023_q1\n\n)\n\nselect * from source", "relation_name": "analytics.albertosantinon7_staging.stg_transactional_src__orders_q1"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-25T17:08:43.697336Z", "completed_at": "2024-06-25T17:08:43.701817Z"}, {"name": "execute", "started_at": "2024-06-25T17:08:43.729409Z", "completed_at": "2024-06-25T17:08:44.712745Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0327677726745605, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b53fe4-0105-4020-0003-34770019ea6e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.acme_ecommerce.stg_reference_data_src__products", "compiled": true, "compiled_code": "with source as (\n\n    select * from acme_ecommerce.reference_data.product\n\n)\n\nselect * from source", "relation_name": "analytics.albertosantinon7_staging.stg_reference_data_src__products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-25T17:08:44.676300Z", "completed_at": "2024-06-25T17:08:44.679734Z"}, {"name": "execute", "started_at": "2024-06-25T17:08:44.680453Z", "completed_at": "2024-06-25T17:08:45.004153Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.34028005599975586, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b53fe4-0105-3f15-0003-347700193e0a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.acme_ecommerce.trn_customer", "compiled": true, "compiled_code": "with customer as (\n\n    select\n\t\"customer code\" as \"customer_code\",\n\t\"first name\" as \"first_name\",\n\t\"last name\" as \"last_name\",\n\t\"email address\" as \"email_address\",\n\t\"iso country code\" as \"country_code\"\n    from analytics.albertosantinon7_staging.stg_reference_data_src__customers\n\n)\n\nselect * from customer", "relation_name": "analytics.albertosantinon7_intermediate.trn_customer"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-25T17:08:44.637240Z", "completed_at": "2024-06-25T17:08:44.642601Z"}, {"name": "execute", "started_at": "2024-06-25T17:08:44.643663Z", "completed_at": "2024-06-25T17:08:45.008241Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3814857006072998, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b53fe4-0105-3f1d-0003-3477001b37f2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.acme_ecommerce.trn_country", "compiled": true, "compiled_code": "with country as (\n\n    select\n \t\"alpha_3_country_code\" as \"country_code\",\n\t\"country\",\n\t\"region\",\n\t\"active_flag\"\n    from analytics.albertosantinon7_staging.stg_reference_data_src__countries\n\n)\n\nselect * from country", "relation_name": "analytics.albertosantinon7_intermediate.trn_country"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-25T17:08:44.660053Z", "completed_at": "2024-06-25T17:08:44.663515Z"}, {"name": "execute", "started_at": "2024-06-25T17:08:44.664313Z", "completed_at": "2024-06-25T17:08:45.014611Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3591501712799072, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b53fe4-0105-4303-0003-3477001a1a12"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.acme_ecommerce.trn_inventory", "compiled": true, "compiled_code": "with inventory as (\n\n    select\n \t\"prodid\" as \"product_id\",\n\t\"stock_arrival_date\",\n\tifnull(\"stock_depleted_date\", to_date('9999-12-31','YYYY-MM-DD')) as \"stock_depleted_date\",\n\t\"purchase_price\"\n    from analytics.albertosantinon7_staging.stg_product_inventory_src__product_inventories\n\n)\n\nselect * from inventory", "relation_name": "analytics.albertosantinon7_intermediate.trn_inventory"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-25T17:08:44.715750Z", "completed_at": "2024-06-25T17:08:44.718743Z"}, {"name": "execute", "started_at": "2024-06-25T17:08:44.719599Z", "completed_at": "2024-06-25T17:08:45.136007Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.42214298248291016, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b53fe4-0105-4020-0003-34770019ea72"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.acme_ecommerce.trn_transactional_orders", "compiled": true, "compiled_code": "with orders_q1 AS\n(\n\n    SELECT\n    \"transaction_id\",\n\tTO_TIMESTAMP_NTZ(\"transaction_timestamp\",'DD/MM/YYYY HH24:MI') as \"transaction_timestamp\",\n\tTO_TIMESTAMP_NTZ(\"shipped_timestamp\",'DD/MM/YYYY HH24:MI') as \"shipped_timestamp\",\n\t\"product_id\",\n\t\"customer_id\",\n\t\"quantity\",\n\t\"unit_price\"\n    FROM analytics.albertosantinon7_staging.stg_transactional_src__orders_q1\n\n),\n\norders_q2 AS\n(\n\n    SELECT\n    \"transaction_id\",\n\tTO_TIMESTAMP_NTZ(\"transaction_timestamp\",'DD/MM/YYYY HH24:MI') as \"transaction_timestamp\",\n\tTO_TIMESTAMP_NTZ(\"shipped_timestamp\",'DD/MM/YYYY HH24:MI') as \"shipped_timestamp\",\n\t\"product_id\",\n\t\"customer_id\",\n\t\"quantity\",\n\t\"unit_price\"\n    FROM analytics.albertosantinon7_staging.stg_transactional_src__orders_q2\n\n),\n\norders_q3 AS\n(\n\n    SELECT\n    \"transaction_id\",\n\tTO_TIMESTAMP_NTZ(\"transaction_timestamp\",'DD/MM/YYYY HH24:MI') as \"transaction_timestamp\",\n\tTO_TIMESTAMP_NTZ(\"shipping_timestamp\",'DD/MM/YYYY HH24:MI') as \"shipped_timestamp\",\n\t\"product_id\",\n\t\"customer_id\",\n\t\"quantity\",\n\t\"unit_price\"\n    FROM analytics.albertosantinon7_staging.stg_transactional_src__orders_q3\n\n),\n\norders_q4 AS\n(\n\n    SELECT\n    \"transaction_id\",\n\tTO_TIMESTAMP_NTZ(\"transaction_timestamp\",'DD/MM/YYYY HH24:MI') as \"transaction_timestamp\",\n\tTO_TIMESTAMP_NTZ(\"shipping_timestamp\",'DD/MM/YYYY HH24:MI') as \"shipped_timestamp\",\n\t\"product_id\",\n\t\"customer_id\",\n\t\"quantity\",\n\t\"unit_price\"\n    FROM analytics.albertosantinon7_staging.stg_transactional_src__orders_q4\n\n)\n\nselect * from orders_q1\nunion\nselect * from orders_q2\nunion\nselect * from orders_q3\nunion\nselect * from orders_q4\norder by 1", "relation_name": "analytics.albertosantinon7_intermediate.trn_transactional_orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-25T17:08:45.023705Z", "completed_at": "2024-06-25T17:08:45.027475Z"}, {"name": "execute", "started_at": "2024-06-25T17:08:45.028350Z", "completed_at": "2024-06-25T17:08:45.488543Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4677860736846924, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b53fe4-0105-4302-0003-34770019dfaa"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.acme_ecommerce.trn_products", "compiled": true, "compiled_code": "with products as (\n\n    select\n\t\"prodid\" as \"product_id\",\n\t\"prodname\" as \"product_name\",\n\t\"prodcat\" as \"product_category\"\n    from analytics.albertosantinon7_staging.stg_reference_data_src__products\n\n)\n\nselect * from products", "relation_name": "analytics.albertosantinon7_intermediate.trn_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-25T17:08:45.496688Z", "completed_at": "2024-06-25T17:08:45.504161Z"}, {"name": "execute", "started_at": "2024-06-25T17:08:45.505431Z", "completed_at": "2024-06-25T17:08:47.746698Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.253321886062622, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b53fe4-0105-3f15-0003-347700193e0e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.acme_ecommerce.sales", "compiled": true, "compiled_code": "with transaction\nas\n\n(\nselect\na.\"transaction_id\"\n, a.\"transaction_timestamp\"\n, a.\"shipped_timestamp\"\n, a.\"product_id\"\n, a.\"customer_id\"\n, b.\"stock_arrival_date\"\n, b.\"stock_depleted_date\"\n, b.\"purchase_price\"\n, a.\"quantity\"\n, a.\"unit_price\"\n, (a.\"unit_price\" - b.\"purchase_price\")*a.\"quantity\" as \"value\"\nfrom analytics.albertosantinon7_intermediate.trn_transactional_orders a \njoin analytics.albertosantinon7_intermediate.trn_inventory b\non a.\"product_id\" = b.\"product_id\"\nwhere to_date(\"transaction_timestamp\") > \"stock_arrival_date\"\nand to_date(\"shipped_timestamp\") < \"stock_depleted_date\"\norder by 1\n),\n\ncustomers as (\n\n\n    select\n    \"customer_code\"\n    , \"first_name\" || \"last_name\" as \"cust_name\"\n    , \"email_address\"\n    , \"country\"\n    , \"region\"\n    from analytics.albertosantinon7_intermediate.trn_customer as a\n    join analytics.albertosantinon7_intermediate.trn_country as b\n    on (a.\"country_code\" = b.\"country_code\")\n    where \"active_flag\" = TRUE\n\n),\n\nproducts as\n(\n\n    select *\n    from analytics.albertosantinon7_intermediate.trn_products\n\n)\n\n, intermediate as (\nselect\nt.*\n, p.\"product_name\"\n, p.\"product_category\"\n, c.\"cust_name\"\n, c.\"email_address\"\n, c.\"country\"\n, c.\"region\"\n, date_part('month', t.\"transaction_timestamp\") as \"transaction_month\"\n, date_part('quarter', t.\"transaction_timestamp\") as \"transaction_quarter\"\n, date_part('year', t.\"transaction_timestamp\") as \"transaction_year\"\n, date_part('month', t.\"shipped_timestamp\") as \"shipping_month\"\n, date_part('quarter', t.\"shipped_timestamp\") as \"shipping_quarter\"\n, date_part('year', t.\"shipped_timestamp\") as \"shipping_year\"\n, case when \"value\" between 0 and 1000 then 'band 1'\n       when \"value\" between 1001 and 5000 then 'band 2'\n       when \"value\" > 5000 then 'band 3'\n  end as \"sales_band\"\nfrom transaction t \njoin products p on t.\"product_id\" = p.\"product_id\"\njoin customers c on t.\"customer_id\" = c.\"customer_code\")\n\nselect\n\"transaction_id\"\n,\"transaction_timestamp\"\n,\"transaction_quarter\"\n,\"transaction_month\"\n,\"transaction_year\"\n,\"shipping_quarter\"\n,\"shipping_month\"\n,\"shipping_year\"\n,\"product_name\"\n,\"product_category\"\n,\"cust_name\"\n,\"email_address\"\n,\"country\"\n,\"region\"\n,\"sales_band\"\nfrom intermediate", "relation_name": "analytics.albertosantinon7_marts.sales"}], "elapsed_time": 6.549678802490234, "args": {"vars": {}, "enable_legacy_logger": false, "use_colors_file": true, "partial_parse": true, "static_parser": true, "version_check": true, "favor_state": false, "use_colors": true, "log_level": "info", "project_dir": "/Users/albertosantinon/Documents/dev/accelerant", "strict_mode": false, "populate_cache": true, "warn_error_options": {"include": [], "exclude": []}, "require_explicit_package_overrides_for_builtin_materializations": false, "quiet": false, "print": true, "defer": false, "cache_selected_only": false, "invocation_command": "dbt run", "log_file_max_bytes": 10485760, "introspect": true, "log_format": "default", "profiles_dir": "/Users/albertosantinon/Documents/dev/accelerant", "log_level_file": "debug", "show_resource_report": false, "log_path": "/Users/albertosantinon/Documents/dev/accelerant/logs", "select": [], "printer_width": 80, "exclude": [], "macro_debugging": false, "partial_parse_file_diff": true, "which": "run", "log_format_file": "debug", "send_anonymous_usage_stats": false, "write_json": true, "indirect_selection": "eager"}}